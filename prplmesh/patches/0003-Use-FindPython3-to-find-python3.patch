From e0ad206984b10657791e2bff63ad9d679f040260 Mon Sep 17 00:00:00 2001
From: Frederik Van Bogaert <frederik.vanbogaert@mind.be>
Date: Tue, 20 Dec 2022 12:07:07 +0100
Subject: [PATCH] Use FindPython3 to find python3

Signed-off-by: Frederik Van Bogaert <frederik.vanbogaert@mind.be>
(cherry picked from commit b6d664c544cda345577736f04ab21b0f80be7325)
---
 CMakeLists.txt                      | 4 ++--
 common/beerocks/tlvf/CMakeLists.txt | 8 ++------
 framework/tlvf/CMakeLists.txt       | 8 ++------
 3 files changed, 6 insertions(+), 14 deletions(-)

diff --git a/CMakeLists.txt b/CMakeLists.txt
index a1f3505afdca..957efacc64e6 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -1,5 +1,5 @@
-cmake_minimum_required(VERSION 3.1)
-cmake_policy(VERSION 3.1)
+cmake_minimum_required(VERSION 3.12)
+cmake_policy(VERSION 3.12)
 include(cmake/multiap-helpers.cmake)
 project(prplmesh
         LANGUAGES C CXX
diff --git a/common/beerocks/tlvf/CMakeLists.txt b/common/beerocks/tlvf/CMakeLists.txt
index 71fb637ab638..439f743058d3 100644
--- a/common/beerocks/tlvf/CMakeLists.txt
+++ b/common/beerocks/tlvf/CMakeLists.txt
@@ -1,17 +1,13 @@
 project(btlvf VERSION ${prplmesh_VERSION})
 
-if ((TARGET_PLATFORM_TYPE STREQUAL "ugw") OR (TARGET_PLATFORM STREQUAL "rdkb"))
-    find_package(PythonInterp REQUIRED)
-else()
-    set(PYTHON_EXECUTABLE python3)
-endif()
+find_package(Python3 REQUIRED COMPONENTS Interpreter)
 
 get_property(PythonTlvf TARGET tlvf PROPERTY PythonTlvf)
 message("-- Inherited ${PythonTlvf} ...")
 
 set(TLVF_DIR ${CMAKE_CURRENT_SOURCE_DIR})
 set(TLVF_OUT ${TLVF_DIR}/AutoGenerated)
-set(TLVF_COMMAND ${PYTHON_EXECUTABLE} ${PythonTlvf} ${TLVF_DIR}/src ${TLVF_DIR}/yaml ${TLVF_OUT} -c ${TLVF_DIR}/tlvf_conf.yaml)
+set(TLVF_COMMAND ${Python3_EXECUTABLE} ${PythonTlvf} ${TLVF_DIR}/src ${TLVF_DIR}/yaml ${TLVF_OUT} -c ${TLVF_DIR}/tlvf_conf.yaml)
 
 message("-- Running ${TLVF_COMMAND} --print-dependencies...")
 execute_process(
diff --git a/framework/tlvf/CMakeLists.txt b/framework/tlvf/CMakeLists.txt
index 41859fe15d7a..a347e2832b88 100644
--- a/framework/tlvf/CMakeLists.txt
+++ b/framework/tlvf/CMakeLists.txt
@@ -1,15 +1,11 @@
 project(tlvf VERSION ${prplmesh_VERSION})
 
-if ((TARGET_PLATFORM_TYPE STREQUAL "ugw") OR (TARGET_PLATFORM STREQUAL "rdkb"))
-    find_package(PythonInterp REQUIRED)
-else()
-    set(PYTHON_EXECUTABLE python3)
-endif()
+find_package(Python3 REQUIRED COMPONENTS Interpreter)
 
 set(TLVF_DIR ${CMAKE_CURRENT_SOURCE_DIR})
 set(PythonTlvf ${TLVF_DIR}/tlvf.py)
 set(TLVF_OUT ${CMAKE_CURRENT_SOURCE_DIR}/AutoGenerated)
-set(TLVF_COMMAND ${PYTHON_EXECUTABLE} ${PythonTlvf} ${TLVF_DIR}/src ${TLVF_DIR}/yaml ${TLVF_OUT} -c ${TLVF_DIR}/tlvf_conf.yaml)
+set(TLVF_COMMAND ${Python3_EXECUTABLE} ${PythonTlvf} ${TLVF_DIR}/src ${TLVF_DIR}/yaml ${TLVF_OUT} -c ${TLVF_DIR}/tlvf_conf.yaml)
 
 set(ENUM_AUTO_PRINT_DIR ${CMAKE_CURRENT_SOURCE_DIR}/../external/enumAutoPrint)
 set(ENUM_AUTO_PRINT_COMMAND ${ENUM_AUTO_PRINT_DIR}/enum_auto_print.py)
